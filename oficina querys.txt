-- Recuperação simples com SELECT
-- Liste todos os clientes cadastrados com seus veículos
SELECT c.NOME AS Cliente, v.MODELO AS Veiculo, v.PLACA
FROM CLIENTE c
JOIN VEICULO v ON c.idCLIENTE = v.ID_CLIENTE;

-- Filtros com WHERE
-- Quais ordens de serviço já foram concluídas?
SELECT idOS, STATUS, DATA_CONCLUSAO, VALOR_TOTAL
FROM OS
WHERE STATUS = 'Concluída';


-- Expressões e Ordenação com ORDER BY
-- Liste os serviços realizados mostrando também o custo total (mão de obra × quantidade), ordenados do mais caro para o mais barato
SELECT 
    s.DESCRICAO,
    s.VALOR_MAO_DE_OBRA,
    osvc.QUANTIDADE,
    (s.VALOR_MAO_DE_OBRA * osvc.QUANTIDADE) AS Custo_Total
FROM OS_SERVICO AS osvc
JOIN SERVICO AS s 
  ON osvc.IDSERVICO = s.idSERVICO
ORDER BY Custo_Total DESC;

-- Agrupamento, HAVING e Junções
-- Quais ordens de serviço utilizaram mais de 2 peças?
SELECT o.idOS,
       SUM(op.QUANTIDADE) AS Total_Pecas
FROM OS o
JOIN OS_PECA op ON o.idOS = op.OS_idOS
GROUP BY o.idOS
HAVING SUM(op.QUANTIDADE) > 2;